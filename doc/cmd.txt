export http_proxy=10.64.1.113:16818
export https_proxy=10.64.1.113:16818

export INSTALL_K3S_VERSION=v1.28.8+k3s1
export INSTALL_K3S_MIRROR=cn
wget https://rancher-mirror.rancher.cn/k3s/k3s-install.sh |  sh -s k3s-install.sh --flannel-backend=none --disable-network-policy --disable=traefik --write-kubeconfig-mode 644 --write-kubeconfig ~/.kube/config
sh k3s-install.sh --flannel-backend=none --disable-network-policy --disable=traefik --write-kubeconfig-mode 644 --write-kubeconfig ~/.kube/config
wget https://raw.githubusercontent.com/kubeovn/kube-ovn/release-1.12/dist/images/install.sh
vim install.sh 
bash -x install.sh 
git clone https://github.com/laoyang103/qdcloud
cd qdcloud/src/main/webapp/WEB-INF/cgi/yml/public/
kubectl apply -f multus-daemonset-thick.yml 
mv /usr/local/bin/kubectl-ko /opt/
echo "source /usr/share/bash-completion/bash_completion" >> ~/.bashrc
echo "source <(kubectl completion bash)" >> ~/.bashrc
wget http://stu.jxit.net.cn:88/k8s/kube-ovn/multus-cni_4.0.2_linux_amd64.tar.gz 
tar -zxf multus-cni_4.0.2_linux_amd64.tar.gz 
cd multus-cni_4.0.2_linux_amd64/
mv multus* /opt/cni/bin/
cat /var/lib/rancher/k3s/server/node-token
kubectl -n kube-system delete daemonsets.apps kube-ovn-pinger 
cd qdcloud/src/main/webapp/WEB-INF/cgi/yml/
kubectl apply -f external-network.yml 
kubectl apply -f enable-vpc-nat-gw.yml 
apt -y install mariadb-client mariadb-client tree net-tools
